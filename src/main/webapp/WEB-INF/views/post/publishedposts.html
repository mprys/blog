<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Create a New Post</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="../../../resources/css/bootstrap.min.css" rel="stylesheet" media="screen" th:href="@{/resources/css/bootstrap.min.css}"/>
    <link href="../../../resources/css/core.css" rel="stylesheet" media="screen" th:href="@{/resources/css/core.css}" />
    <link href="../../../resources/css/bootstrap-wysihtml5.css" rel="stylesheet" type="text/css" th:href="@{/resources/css/bootstrap-wysihtml5.css}" />
    <link href="../../../resources/css/bootstrap3-wysiwyg5-color.css" rel="stylesheet" type="text/css" th:href="@{/resources/css/bootstrap3-wysiwyg5-color.css}" />

    <script src="../../../resources/js/jquery-1.10.2.min.js" th:src="@{/resources/js/jquery-1.10.2.min.js}"></script>
    <script src="../../../resources/js/bootstrap.min.js" th:src="@{/resources/js/bootstrap.min.js}"></script> 
    <script src="../../../resources/js/wysihtml5-0.3.0.js" th:src="@{/resources/js/wysihtml5-0.3.0.js}" type="text/javascript"></script>
    <script src="../../../resources/js/bootstrap3-wysihtml5.js" type="text/javascript" th:src="@{/resources/js/bootstrap3-wysihtml5.js}"></script>

<script>
    	$(document).ready(function(){

    			$.ajax({
        			url : "/PathSF-Example/post/all",
	            	//data : $("#createPost").serialize(),
	            	type : "GET",
	            	dataType : "json",
	            	success : function(json) {
	            			var ul = $("#listgroup");
	       					$.each(json, function(idx, elem){
	       						ul.append('<a href="#" class="list-group-item">' + elem.title + ' <span class="badge">' + elem.id + '</span>' + '</a>');
	       					});
	            	 	},
	            	error : function( xhr, status ) {
	            	        alert("there was a problem!" );
	            	    }
    			});
    			
    			$('#listgroup').on('click', '.list-group-item', function() {
    			    var text = $(this).text();
    			    var id = text[text.length - 1];
    			    
    			    $.ajax({
    			    	url : "/PathSF-Example/post/details/" + id,
    			    	type : "GET",
    			    	dataType : "json",
    			    	success : function(json){
    			    		$("#listgroup").hide();
    			    		$("#messageDiv").addClass("alert alert-dismissable alert-success");
	            			$("#resultMessage").text("Selected post id " + id);
	            			$("#postDetails").addClass("jumbotron");
	            			$("#title").text(json['title']);
	            			$("#content").html(json['content']);
	            			$("#closeButton").show();
    			    	},
    			    	error : function(xhr, status){
    			    		alert("error");
    			    	}
    			    });
    			});
    	});
</script>
</head>

<body>
<div th:substituteby="fragments/header :: header">&nbsp;</div>
<div  class="container" >
<div id="messageDiv">
   <button id="closeButton" type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
   <span id="resultMessage"></span>
</div>
<div id="postDetails">
	<p id="title"></p>
	<div id="content"></div>
	<a id="publishLink"></a>
	
	<div class="list-group" id="listgroup">

</div>
</div>
</div>
</body>
</html>